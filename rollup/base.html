<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Rollup基础 | MrZhao&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/assets/logo.jpg">
    <meta name="description" content="个人博客">
    
    <link rel="preload" href="/assets/css/0.styles.ddf5beda.css" as="style"><link rel="preload" href="/assets/js/app.acb235b1.js" as="script"><link rel="preload" href="/assets/js/2.d372d77b.js" as="script"><link rel="preload" href="/assets/js/1.37fa4b6c.js" as="script"><link rel="preload" href="/assets/js/93.efccb64b.js" as="script"><link rel="prefetch" href="/assets/js/10.82b2071b.js"><link rel="prefetch" href="/assets/js/100.e63403ed.js"><link rel="prefetch" href="/assets/js/101.f5129fd2.js"><link rel="prefetch" href="/assets/js/102.d0ddf2d8.js"><link rel="prefetch" href="/assets/js/103.9926bfcb.js"><link rel="prefetch" href="/assets/js/104.af476e27.js"><link rel="prefetch" href="/assets/js/105.c8937ef6.js"><link rel="prefetch" href="/assets/js/106.1397eb8d.js"><link rel="prefetch" href="/assets/js/107.9afde75e.js"><link rel="prefetch" href="/assets/js/108.cb71564c.js"><link rel="prefetch" href="/assets/js/109.367dbeed.js"><link rel="prefetch" href="/assets/js/11.4dba772f.js"><link rel="prefetch" href="/assets/js/110.49f4bab3.js"><link rel="prefetch" href="/assets/js/111.5d4c672e.js"><link rel="prefetch" href="/assets/js/112.edc0db73.js"><link rel="prefetch" href="/assets/js/113.9852316c.js"><link rel="prefetch" href="/assets/js/114.ffe9fe06.js"><link rel="prefetch" href="/assets/js/115.564724ca.js"><link rel="prefetch" href="/assets/js/116.5cd792a1.js"><link rel="prefetch" href="/assets/js/117.4b4aaf18.js"><link rel="prefetch" href="/assets/js/118.6888441c.js"><link rel="prefetch" href="/assets/js/119.b8950c5c.js"><link rel="prefetch" href="/assets/js/12.27965b5f.js"><link rel="prefetch" href="/assets/js/120.c92b4b7a.js"><link rel="prefetch" href="/assets/js/121.0d5986c2.js"><link rel="prefetch" href="/assets/js/122.e54d395a.js"><link rel="prefetch" href="/assets/js/123.7de3e59a.js"><link rel="prefetch" href="/assets/js/124.aec1c47d.js"><link rel="prefetch" href="/assets/js/125.12be05e6.js"><link rel="prefetch" href="/assets/js/13.4895e118.js"><link rel="prefetch" href="/assets/js/14.efee2099.js"><link rel="prefetch" href="/assets/js/15.08f58c28.js"><link rel="prefetch" href="/assets/js/16.e25cce72.js"><link rel="prefetch" href="/assets/js/17.73af3b17.js"><link rel="prefetch" href="/assets/js/18.a5cd26c5.js"><link rel="prefetch" href="/assets/js/19.5b5def25.js"><link rel="prefetch" href="/assets/js/20.9ae07869.js"><link rel="prefetch" href="/assets/js/21.1f0d465b.js"><link rel="prefetch" href="/assets/js/22.0e74832d.js"><link rel="prefetch" href="/assets/js/23.7d3158db.js"><link rel="prefetch" href="/assets/js/24.83abb9ba.js"><link rel="prefetch" href="/assets/js/25.c853c4de.js"><link rel="prefetch" href="/assets/js/26.e4ede223.js"><link rel="prefetch" href="/assets/js/27.3b00c66b.js"><link rel="prefetch" href="/assets/js/28.123c02f0.js"><link rel="prefetch" href="/assets/js/29.981e7943.js"><link rel="prefetch" href="/assets/js/3.5e61bf8f.js"><link rel="prefetch" href="/assets/js/30.47d8c561.js"><link rel="prefetch" href="/assets/js/31.b0370337.js"><link rel="prefetch" href="/assets/js/32.f5639ab2.js"><link rel="prefetch" href="/assets/js/33.4d982e7e.js"><link rel="prefetch" href="/assets/js/34.476ca9ee.js"><link rel="prefetch" href="/assets/js/35.d6c54e1c.js"><link rel="prefetch" href="/assets/js/36.bb6f614a.js"><link rel="prefetch" href="/assets/js/37.a8ecfac1.js"><link rel="prefetch" href="/assets/js/38.e7d16fe5.js"><link rel="prefetch" href="/assets/js/39.7dc7f49e.js"><link rel="prefetch" href="/assets/js/4.30f14711.js"><link rel="prefetch" href="/assets/js/40.d05cfc3c.js"><link rel="prefetch" href="/assets/js/41.38899e70.js"><link rel="prefetch" href="/assets/js/42.0b533d65.js"><link rel="prefetch" href="/assets/js/43.53d193d3.js"><link rel="prefetch" href="/assets/js/44.3b96fad7.js"><link rel="prefetch" href="/assets/js/45.eef657e9.js"><link rel="prefetch" href="/assets/js/46.b2f1fd36.js"><link rel="prefetch" href="/assets/js/47.9c09556d.js"><link rel="prefetch" href="/assets/js/48.ce176bc3.js"><link rel="prefetch" href="/assets/js/49.f55f1fca.js"><link rel="prefetch" href="/assets/js/5.756b6e8a.js"><link rel="prefetch" href="/assets/js/50.beb1776a.js"><link rel="prefetch" href="/assets/js/51.d31795c1.js"><link rel="prefetch" href="/assets/js/52.19761715.js"><link rel="prefetch" href="/assets/js/53.cf691bec.js"><link rel="prefetch" href="/assets/js/54.69111173.js"><link rel="prefetch" href="/assets/js/55.6a5031d0.js"><link rel="prefetch" href="/assets/js/56.a6d0b60c.js"><link rel="prefetch" href="/assets/js/57.9a437f90.js"><link rel="prefetch" href="/assets/js/58.8f3c8e43.js"><link rel="prefetch" href="/assets/js/59.dc73bd90.js"><link rel="prefetch" href="/assets/js/6.c6e8dcba.js"><link rel="prefetch" href="/assets/js/60.8431e9e8.js"><link rel="prefetch" href="/assets/js/61.31a7a75b.js"><link rel="prefetch" href="/assets/js/62.a78d06bf.js"><link rel="prefetch" href="/assets/js/63.b40afbd7.js"><link rel="prefetch" href="/assets/js/64.cb8ba378.js"><link rel="prefetch" href="/assets/js/65.608bc3be.js"><link rel="prefetch" href="/assets/js/66.c430f2d9.js"><link rel="prefetch" href="/assets/js/67.96a5041b.js"><link rel="prefetch" href="/assets/js/68.d152d1b8.js"><link rel="prefetch" href="/assets/js/69.54bd8d5c.js"><link rel="prefetch" href="/assets/js/7.b18f4475.js"><link rel="prefetch" href="/assets/js/70.d10c0bb6.js"><link rel="prefetch" href="/assets/js/71.1b530077.js"><link rel="prefetch" href="/assets/js/72.76b37ee5.js"><link rel="prefetch" href="/assets/js/73.1d72d0ea.js"><link rel="prefetch" href="/assets/js/74.136395b3.js"><link rel="prefetch" href="/assets/js/75.163b827e.js"><link rel="prefetch" href="/assets/js/76.29c6b42d.js"><link rel="prefetch" href="/assets/js/77.ce9ee614.js"><link rel="prefetch" href="/assets/js/78.299f9cda.js"><link rel="prefetch" href="/assets/js/79.fe755e03.js"><link rel="prefetch" href="/assets/js/80.1884cea8.js"><link rel="prefetch" href="/assets/js/81.68edf7ac.js"><link rel="prefetch" href="/assets/js/82.a4b444d1.js"><link rel="prefetch" href="/assets/js/83.055b0579.js"><link rel="prefetch" href="/assets/js/84.6d10a5cc.js"><link rel="prefetch" href="/assets/js/85.56cc70f5.js"><link rel="prefetch" href="/assets/js/86.46400f67.js"><link rel="prefetch" href="/assets/js/87.0e8035e0.js"><link rel="prefetch" href="/assets/js/88.e86cd82a.js"><link rel="prefetch" href="/assets/js/89.1115943f.js"><link rel="prefetch" href="/assets/js/90.1ec59b21.js"><link rel="prefetch" href="/assets/js/91.92c56bfd.js"><link rel="prefetch" href="/assets/js/92.98f06763.js"><link rel="prefetch" href="/assets/js/94.bd47fc37.js"><link rel="prefetch" href="/assets/js/95.1aedc256.js"><link rel="prefetch" href="/assets/js/96.f7ec82ea.js"><link rel="prefetch" href="/assets/js/97.1903528c.js"><link rel="prefetch" href="/assets/js/98.b1d996fc.js"><link rel="prefetch" href="/assets/js/99.a7062bf9.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.cc58001a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ddf5beda.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">MrZhao's blog</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/feBase/js/" class="nav-link">
  Javascript
</a></li><li class="dropdown-item"><!----> <a href="/ES6/base.html" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/feBase/css/1.html" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/feBase/browser/1.html" class="nav-link">
  浏览器
</a></li><li class="dropdown-item"><!----> <a href="/feBase/mini/1.html" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/react/1.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/ssr/" class="nav-link">
  SSR
</a></li><li class="dropdown-item"><!----> <a href="/cloudflare/tunnel.html" class="nav-link">
  Cloudflare
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="打包工具" class="dropdown-title"><span class="title">打包工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="打包工具" class="mobile-dropdown-title"><span class="title">打包工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/webpack/base.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/rollup/base.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Rollup
</a></li></ul></div></div><div class="nav-item"><a href="/node/" class="nav-link">
  Node
</a></div><div class="nav-item"><a href="/leetcode/array.html" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/test/" class="nav-link">
  常见问题
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/feBase/js/" class="nav-link">
  Javascript
</a></li><li class="dropdown-item"><!----> <a href="/ES6/base.html" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/feBase/css/1.html" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/feBase/browser/1.html" class="nav-link">
  浏览器
</a></li><li class="dropdown-item"><!----> <a href="/feBase/mini/1.html" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/react/1.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/ssr/" class="nav-link">
  SSR
</a></li><li class="dropdown-item"><!----> <a href="/cloudflare/tunnel.html" class="nav-link">
  Cloudflare
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="打包工具" class="dropdown-title"><span class="title">打包工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="打包工具" class="mobile-dropdown-title"><span class="title">打包工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/webpack/base.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/rollup/base.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Rollup
</a></li></ul></div></div><div class="nav-item"><a href="/node/" class="nav-link">
  Node
</a></div><div class="nav-item"><a href="/leetcode/array.html" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/test/" class="nav-link">
  常见问题
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Rollup</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rollup/base.html" aria-current="page" class="active sidebar-link">Rollup基础</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p></p><div class="table-of-contents"><ul><li><a href="#rollup是什么">Rollup是什么</a></li><li><a href="#webpack核心概念">webpack核心概念</a></li><li><a href="#filename-和-chunkfilename、webpackchunkname">filename 和 chunkFilename、webpackChunkName</a><ul><li><a href="#filename">filename</a></li><li><a href="#chunkfilename">chunkFilename</a></li><li><a href="#webpackchunkname">webpackChunkName</a></li></ul></li><li><a href="#webpackprefetch、webpackpreload">webpackPrefetch、webpackPreload</a><ul><li><a href="#webpackprefetch">webpackPrefetch</a></li><li><a href="#webpackpreload">webpackPreload</a></li></ul></li><li><a href="#hash、chunkhash、contenthash">hash、chunkhash、contenthash</a><ul><li><a href="#hash">hash</a></li><li><a href="#chunkhash">chunkhash</a></li><li><a href="#contenthash">contenthash</a></li></ul></li><li><a href="#sourse-map的应用">sourse-map的应用</a></li></ul></div><p></p> <h2 id="rollup是什么"><a href="#rollup是什么" class="header-anchor">#</a> Rollup是什么</h2> <blockquote><p><code>Rollup</code>则是一个专注于<code>JavaScript</code>库打包的工具，它的设计目标是尽可能地将代码打包成最小化的形式，以提高<code>JavaScript</code>库的性能和体积。<code>Rollup</code>采用Tree-shaking算法和ES6模块规范，可以消除冗余的代码，并将整个库打包成一个独立的文件。相比<code>Webpack</code>，<code>Rollup</code>的配置简单，打包速度更快，但其功能相对较少，主要适用于构建纯<code>JavaScript</code>库。</p></blockquote> <p>因此，如果你需要构建复杂的Web应用程序，包含多种前端技术和功能，可以考虑使用<code>Webpack</code>；如果你需要构建纯<code>JavaScript</code>库，强调性能和体积，可以选择<code>Rollup</code>。当然，在实际项目中，<code>Webpack</code>和<code>Rollup</code>也可以结合使用，根据具体情况进行取舍。</p> <h2 id="webpack核心概念"><a href="#webpack核心概念" class="header-anchor">#</a> webpack核心概念</h2> <div class="custom-block tip"><p class="custom-block-title">核心</p> <p><code>Rollup</code> 配置中需要理解的几个核心概念 ：<strong><code>input</code></strong>，<strong><code>output</code></strong>，<strong><code>plugins</code></strong>，<strong><code>external</code></strong>，<strong><code>watch</code></strong></p> <ul><li><p><strong><code>Entry</code></strong>：指定<code>webpack</code>开始构建的入口模块，从该模块开始构并计算出直接或间接依赖的模块或者库。</p></li> <li><p><strong><code>Output</code></strong>：告诉<code>webpack</code>如何命名输出文件以及输出的目录</p></li> <li><p><strong><code>Loaders</code></strong>：由于<code>webpack</code>只能处理<code>JavaScript</code>，所以我们需要将一些非<code>js</code>文件处理成<code>webpack</code>能够处理的模块，比如<code>.vue、.scss</code>等文件。</p></li> <li><p><strong><code>Plugins</code></strong>：<code>plugin</code>有着很强的能力，从打包优化和压缩，一直到重新定义环境中的变量。辅助<code>webpack</code>更好的按照我们指定的方式打包代码。</p></li> <li><p><strong><code>module</code></strong>：我们自己写的代码文件，一个文件就相当于一个模块，不管是css、js都是模块。</p></li> <li><p><strong><code>Chunk</code></strong>：当<code>webpack</code>根据我们传入的入口文件将我们写的<code>module</code>进行打包时，会根据文件的引用关系，生成<code>chunk</code>，将一个模块中用到的代码(包括引用的)都生成到一个<code>chunk</code>。额外打包的代码会被单独分出一个文件，实现单独加载，但是属于同一个<code>chunk</code>，<code>webpack</code>会建立内部关系。</p></li></ul> <p><code>coding split</code>的产物，我们可以把一些代码打包成一个单独的<code>Chunk</code>，比如某些公共模块、组件、第三方包，更好的利用缓存。或者按需加载某些功能模块，优化加载时间。在<code>webpack3</code>中我们使用<code>CommonsChunkPlugin</code>将一些公共代码分割成一个<code>chuak</code>，实现单独加载。在webpack4中我们使用<code>SplitChunksPlugin</code></p> <ul><li><strong><code>bundle</code></strong>：<code>webpack</code>将<code>chunk</code>文件处理好之后，最终会输出<code>bundle</code>文件，<code>bundle</code>文件包含了经过压缩和编译的最终代码文件，可以直接在浏览器中运行。</li></ul> <p>一般来说一个<code>chunk</code>对应一个<code>bundle</code>，但是一个<code>chunk</code>也可以对应多个<code>bundle</code>，比如对于同一个<code>chunk</code>的需要额外抽离的<code>css</code>文件</p></div> <h2 id="filename-和-chunkfilename、webpackchunkname"><a href="#filename-和-chunkfilename、webpackchunkname" class="header-anchor">#</a> filename 和 chunkFilename、webpackChunkName</h2> <h3 id="filename"><a href="#filename" class="header-anchor">#</a> filename</h3> <div class="custom-block tip"><p class="custom-block-title">filename</p> <p><code>filename</code>就是打包出来的文件的名称，一般在<code>output</code>对象中会用到，在<code>MiniCssExtractPlugin</code>额外提取CSS插件中也会用到，<code>output.filename</code>的输出文件名是<code>[name].min.js</code>,<code>[name]</code>代表入口名称。</p></div> <h3 id="chunkfilename"><a href="#chunkfilename" class="header-anchor">#</a> chunkFilename</h3> <div class="custom-block tip"><p class="custom-block-title">chunkFilename</p> <p><code>chunkFilename</code>指的是不在<code>entry</code>中，却需要额外被打包出来的文件的名称，一般是需要懒加载的模块，比如<code>loadsh</code>文件。当<code>output.chunkFilename</code>没有被指定时，默认就会把chunk文件的id号当成前缀，比如<code>1.min.js</code>。</p></div> <h3 id="webpackchunkname"><a href="#webpackchunkname" class="header-anchor">#</a> webpackChunkName</h3> <div class="custom-block tip"><p class="custom-block-title">webpackChunkName</p> <p>对于多个需要异步加载的文件，如果写成<code>[name].bundle.js</code>,就会打包出<code>1.bundle.js</code>这种辨识度不高的文件名称，区分起来十分困难，这时候就可以用<code>webpackChunkName</code>注释 来标识异步加载的文件名：在import导入的时候，以注释的方式为引入的文件起别名，比如<code>await import(/* webpackChunkName: &quot;lodash&quot; */ 'lodash')</code>,这样打包出来的就是<code>vendors~lodash.bundle.js</code>，<code>vendors~</code>的前缀是<code>webpack</code>的懒加载插件<code>SplitChunksPlugin</code>里的默认配置增加的。</p> <p><code>webpackChunkName</code>就是为预加载的文件取别名</p></div> <h2 id="webpackprefetch、webpackpreload"><a href="#webpackprefetch、webpackpreload" class="header-anchor">#</a> webpackPrefetch、webpackPreload</h2> <h3 id="webpackprefetch"><a href="#webpackprefetch" class="header-anchor">#</a> webpackPrefetch</h3> <div class="custom-block tip"><p class="custom-block-title">webpackPrefetch</p> <p>预获取配置。对于懒加载的文件，只有我们需要的时候才会引入，比如点击按钮加载<code>loadsh</code>，只有点击的时候才会才会加载<code>lodash</code>：懒加载时，会动态创建一个<code>script</code>标签，被添加到<code>head</code>头里加载资源。如果我们在<code>import</code>的时候添加<code>webpackPrefetch</code>注释，会将需要预获取的文件在请求中优先级变为<code>Lowest</code>，不会等到点击按钮的时候再加载文件，而会在父<code>chunk</code>文件加载完成后，空闲时加载<code>lodash</code>文件。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>prefetch<span class="token punctuation">&quot;</span></span> <span class="token attr-name">as</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>script<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>vendors-loadsh.bundle.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div></div> <h3 id="webpackpreload"><a href="#webpackpreload" class="header-anchor">#</a> webpackPreload</h3> <div class="custom-block tip"><p class="custom-block-title">webpackPreload</p> <p>需要在<code>webpack</code>中使用<code>preload-webpack-plugin</code>插件，并在需要预先加载的添加<code>/* webpackPreload: true */</code>来实现预加载配置。加了<code>webpackPreload</code>注释的<code>chunk</code>会在父<code>chunk</code>加载时，以并行的方式加载,将需要预加载的文件在请求中优先级提升到<code>High</code>。原理是利用<code>link</code>标签也能加载<code>js</code>的原理，并增加<code>preload</code>属性，来实现的预加载。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preload<span class="token punctuation">&quot;</span></span> <span class="token attr-name">as</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>script<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div></div> <h2 id="hash、chunkhash、contenthash"><a href="#hash、chunkhash、contenthash" class="header-anchor">#</a> hash、chunkhash、contenthash</h2> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>哈希一般都是配合<code>CDN</code>缓存来使用的。如果文件内容改变了，那么文件的哈希值也会改变，对应的<code>HTML</code>引用的<code>URL</code>地址也会改变，用户请求时，<code>CDN</code>服务器发现文件哈希更新了，会从源服务器上拉取对应的数据，更新本地缓存</p></div> <h3 id="hash"><a href="#hash" class="header-anchor">#</a> hash</h3> <div class="custom-block tip"><p class="custom-block-title">hash</p> <p><code>hash</code>的计算是跟项目的构建相关的，项目每次构建都会生成一个新的构建<code>hash</code>值，输出的文件名中如果带有<code>hash</code>值<code>[name].[hash].js</code>,打包出的文件就会带上项目构建生成的<code>hash</code>，比如<code>index.def5949da1857d01b87e.js</code>。</p></div> <h3 id="chunkhash"><a href="#chunkhash" class="header-anchor">#</a> chunkhash</h3> <div class="custom-block tip"><p class="custom-block-title">chunkhash</p> <p>如果都以<code>hash</code>来命名，那么每次打包，都会生成新的<code>hash</code>，这样所有资源的名字都会变，对于内容没有改变的文件，就失去了<code>CDN</code>缓存的作用。<code>chunkhash</code>就解决了这个问题，根据不同的入口文件进行依赖解析、构建对应的<code>chunk</code>，生成不同的<code>chunkhash</code>。当有文件改变时，只有属于同一个<code>chunk</code>的文件名称才会改变。</p></div> <h3 id="contenthash"><a href="#contenthash" class="header-anchor">#</a> contenthash</h3> <div class="custom-block tip"><p class="custom-block-title">contenthash</p> <p>使用<code>chunkhash</code>时，其中有一个文件改变了，会生成新的<code>chunkhash</code>，那么属于同一个<code>chunk</code>的其他文件的名称也会变，但是其他文件并没有发生变化，这样也会浪费<code>CDN</code>缓存。<code>contenthash</code>就是解决这个问题的，<code>contenthash</code>是根据文件内容生成的唯一<code>hash</code>值，当文件内容不改变时，<code>contenthash</code>不会改变。一般额外提取出来的<code>css</code>会使用<code>contenthash</code>作为名称。</p></div> <h2 id="sourse-map的应用"><a href="#sourse-map的应用" class="header-anchor">#</a> sourse-map的应用</h2> <div class="custom-block tip"><p class="custom-block-title">sourse-map</p> <p><code>sourse-map</code>,就是一份源码和转换后代码的映射文件。</p> <p><code>devtool</code>常用值：</p> <ul><li>1、<code>source-map</code>:大而全，啥都有，<code>webpack</code>构建时间变长，看情况使用。</li> <li>2、<code>cheap-sourse-map</code>:<code>cheap</code>，就是廉价的意思，只会映射到行，没有列的映射，而且是转换过的代码。响应的体积会小很多。</li> <li>3、<code>cheap-module-eval-source-map</code>:开发环境可使用，在构建速度报错提醒上做了比较好的均衡。</li> <li>4、<code>cheap-module-source-map</code>:线上环境一般是不配置<code>source-map</code>的，如果想要捕捉线上的代码报错，可以用这个。</li></ul> <p>开发环境一般使用<code>cheap-module-eval-source-map</code>或者<code>cheap-sourse-map</code>，区别如下
<img src="/assets/webpack-devtool.png" alt="webpack-devtool"></p></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2/21/2023, 3:05:32 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.acb235b1.js" defer></script><script src="/assets/js/2.d372d77b.js" defer></script><script src="/assets/js/1.37fa4b6c.js" defer></script><script src="/assets/js/93.efccb64b.js" defer></script>
  </body>
</html>
