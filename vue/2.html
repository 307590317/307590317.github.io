<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue路由 | MrZhao&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/assets/logo.jpg">
    <meta name="description" content="个人博客">
    
    <link rel="preload" href="/assets/css/0.styles.ddf5beda.css" as="style"><link rel="preload" href="/assets/js/app.acb235b1.js" as="script"><link rel="preload" href="/assets/js/2.d372d77b.js" as="script"><link rel="preload" href="/assets/js/1.37fa4b6c.js" as="script"><link rel="preload" href="/assets/js/105.c8937ef6.js" as="script"><link rel="prefetch" href="/assets/js/10.82b2071b.js"><link rel="prefetch" href="/assets/js/100.e63403ed.js"><link rel="prefetch" href="/assets/js/101.f5129fd2.js"><link rel="prefetch" href="/assets/js/102.d0ddf2d8.js"><link rel="prefetch" href="/assets/js/103.9926bfcb.js"><link rel="prefetch" href="/assets/js/104.af476e27.js"><link rel="prefetch" href="/assets/js/106.1397eb8d.js"><link rel="prefetch" href="/assets/js/107.9afde75e.js"><link rel="prefetch" href="/assets/js/108.cb71564c.js"><link rel="prefetch" href="/assets/js/109.367dbeed.js"><link rel="prefetch" href="/assets/js/11.4dba772f.js"><link rel="prefetch" href="/assets/js/110.49f4bab3.js"><link rel="prefetch" href="/assets/js/111.5d4c672e.js"><link rel="prefetch" href="/assets/js/112.edc0db73.js"><link rel="prefetch" href="/assets/js/113.9852316c.js"><link rel="prefetch" href="/assets/js/114.ffe9fe06.js"><link rel="prefetch" href="/assets/js/115.564724ca.js"><link rel="prefetch" href="/assets/js/116.5cd792a1.js"><link rel="prefetch" href="/assets/js/117.4b4aaf18.js"><link rel="prefetch" href="/assets/js/118.6888441c.js"><link rel="prefetch" href="/assets/js/119.b8950c5c.js"><link rel="prefetch" href="/assets/js/12.27965b5f.js"><link rel="prefetch" href="/assets/js/120.c92b4b7a.js"><link rel="prefetch" href="/assets/js/121.0d5986c2.js"><link rel="prefetch" href="/assets/js/122.e54d395a.js"><link rel="prefetch" href="/assets/js/123.7de3e59a.js"><link rel="prefetch" href="/assets/js/124.aec1c47d.js"><link rel="prefetch" href="/assets/js/125.12be05e6.js"><link rel="prefetch" href="/assets/js/13.4895e118.js"><link rel="prefetch" href="/assets/js/14.efee2099.js"><link rel="prefetch" href="/assets/js/15.08f58c28.js"><link rel="prefetch" href="/assets/js/16.e25cce72.js"><link rel="prefetch" href="/assets/js/17.73af3b17.js"><link rel="prefetch" href="/assets/js/18.a5cd26c5.js"><link rel="prefetch" href="/assets/js/19.5b5def25.js"><link rel="prefetch" href="/assets/js/20.9ae07869.js"><link rel="prefetch" href="/assets/js/21.1f0d465b.js"><link rel="prefetch" href="/assets/js/22.0e74832d.js"><link rel="prefetch" href="/assets/js/23.7d3158db.js"><link rel="prefetch" href="/assets/js/24.83abb9ba.js"><link rel="prefetch" href="/assets/js/25.c853c4de.js"><link rel="prefetch" href="/assets/js/26.e4ede223.js"><link rel="prefetch" href="/assets/js/27.3b00c66b.js"><link rel="prefetch" href="/assets/js/28.123c02f0.js"><link rel="prefetch" href="/assets/js/29.981e7943.js"><link rel="prefetch" href="/assets/js/3.5e61bf8f.js"><link rel="prefetch" href="/assets/js/30.47d8c561.js"><link rel="prefetch" href="/assets/js/31.b0370337.js"><link rel="prefetch" href="/assets/js/32.f5639ab2.js"><link rel="prefetch" href="/assets/js/33.4d982e7e.js"><link rel="prefetch" href="/assets/js/34.476ca9ee.js"><link rel="prefetch" href="/assets/js/35.d6c54e1c.js"><link rel="prefetch" href="/assets/js/36.bb6f614a.js"><link rel="prefetch" href="/assets/js/37.a8ecfac1.js"><link rel="prefetch" href="/assets/js/38.e7d16fe5.js"><link rel="prefetch" href="/assets/js/39.7dc7f49e.js"><link rel="prefetch" href="/assets/js/4.30f14711.js"><link rel="prefetch" href="/assets/js/40.d05cfc3c.js"><link rel="prefetch" href="/assets/js/41.38899e70.js"><link rel="prefetch" href="/assets/js/42.0b533d65.js"><link rel="prefetch" href="/assets/js/43.53d193d3.js"><link rel="prefetch" href="/assets/js/44.3b96fad7.js"><link rel="prefetch" href="/assets/js/45.eef657e9.js"><link rel="prefetch" href="/assets/js/46.b2f1fd36.js"><link rel="prefetch" href="/assets/js/47.9c09556d.js"><link rel="prefetch" href="/assets/js/48.ce176bc3.js"><link rel="prefetch" href="/assets/js/49.f55f1fca.js"><link rel="prefetch" href="/assets/js/5.756b6e8a.js"><link rel="prefetch" href="/assets/js/50.beb1776a.js"><link rel="prefetch" href="/assets/js/51.d31795c1.js"><link rel="prefetch" href="/assets/js/52.19761715.js"><link rel="prefetch" href="/assets/js/53.cf691bec.js"><link rel="prefetch" href="/assets/js/54.69111173.js"><link rel="prefetch" href="/assets/js/55.6a5031d0.js"><link rel="prefetch" href="/assets/js/56.a6d0b60c.js"><link rel="prefetch" href="/assets/js/57.9a437f90.js"><link rel="prefetch" href="/assets/js/58.8f3c8e43.js"><link rel="prefetch" href="/assets/js/59.dc73bd90.js"><link rel="prefetch" href="/assets/js/6.c6e8dcba.js"><link rel="prefetch" href="/assets/js/60.8431e9e8.js"><link rel="prefetch" href="/assets/js/61.31a7a75b.js"><link rel="prefetch" href="/assets/js/62.a78d06bf.js"><link rel="prefetch" href="/assets/js/63.b40afbd7.js"><link rel="prefetch" href="/assets/js/64.cb8ba378.js"><link rel="prefetch" href="/assets/js/65.608bc3be.js"><link rel="prefetch" href="/assets/js/66.c430f2d9.js"><link rel="prefetch" href="/assets/js/67.96a5041b.js"><link rel="prefetch" href="/assets/js/68.d152d1b8.js"><link rel="prefetch" href="/assets/js/69.54bd8d5c.js"><link rel="prefetch" href="/assets/js/7.b18f4475.js"><link rel="prefetch" href="/assets/js/70.d10c0bb6.js"><link rel="prefetch" href="/assets/js/71.1b530077.js"><link rel="prefetch" href="/assets/js/72.76b37ee5.js"><link rel="prefetch" href="/assets/js/73.1d72d0ea.js"><link rel="prefetch" href="/assets/js/74.136395b3.js"><link rel="prefetch" href="/assets/js/75.163b827e.js"><link rel="prefetch" href="/assets/js/76.29c6b42d.js"><link rel="prefetch" href="/assets/js/77.ce9ee614.js"><link rel="prefetch" href="/assets/js/78.299f9cda.js"><link rel="prefetch" href="/assets/js/79.fe755e03.js"><link rel="prefetch" href="/assets/js/80.1884cea8.js"><link rel="prefetch" href="/assets/js/81.68edf7ac.js"><link rel="prefetch" href="/assets/js/82.a4b444d1.js"><link rel="prefetch" href="/assets/js/83.055b0579.js"><link rel="prefetch" href="/assets/js/84.6d10a5cc.js"><link rel="prefetch" href="/assets/js/85.56cc70f5.js"><link rel="prefetch" href="/assets/js/86.46400f67.js"><link rel="prefetch" href="/assets/js/87.0e8035e0.js"><link rel="prefetch" href="/assets/js/88.e86cd82a.js"><link rel="prefetch" href="/assets/js/89.1115943f.js"><link rel="prefetch" href="/assets/js/90.1ec59b21.js"><link rel="prefetch" href="/assets/js/91.92c56bfd.js"><link rel="prefetch" href="/assets/js/92.98f06763.js"><link rel="prefetch" href="/assets/js/93.efccb64b.js"><link rel="prefetch" href="/assets/js/94.bd47fc37.js"><link rel="prefetch" href="/assets/js/95.1aedc256.js"><link rel="prefetch" href="/assets/js/96.f7ec82ea.js"><link rel="prefetch" href="/assets/js/97.1903528c.js"><link rel="prefetch" href="/assets/js/98.b1d996fc.js"><link rel="prefetch" href="/assets/js/99.a7062bf9.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.cc58001a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ddf5beda.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">MrZhao's blog</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/feBase/js/" class="nav-link">
  Javascript
</a></li><li class="dropdown-item"><!----> <a href="/ES6/base.html" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/feBase/css/1.html" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/feBase/browser/1.html" class="nav-link">
  浏览器
</a></li><li class="dropdown-item"><!----> <a href="/feBase/mini/1.html" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link router-link-active">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/react/1.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/ssr/" class="nav-link">
  SSR
</a></li><li class="dropdown-item"><!----> <a href="/cloudflare/tunnel.html" class="nav-link">
  Cloudflare
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="打包工具" class="dropdown-title"><span class="title">打包工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="打包工具" class="mobile-dropdown-title"><span class="title">打包工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/webpack/base.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/rollup/base.html" class="nav-link">
  Rollup
</a></li></ul></div></div><div class="nav-item"><a href="/node/" class="nav-link">
  Node
</a></div><div class="nav-item"><a href="/leetcode/array.html" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/test/" class="nav-link">
  常见问题
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/feBase/js/" class="nav-link">
  Javascript
</a></li><li class="dropdown-item"><!----> <a href="/ES6/base.html" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/feBase/css/1.html" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/feBase/browser/1.html" class="nav-link">
  浏览器
</a></li><li class="dropdown-item"><!----> <a href="/feBase/mini/1.html" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link router-link-active">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/react/1.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/ssr/" class="nav-link">
  SSR
</a></li><li class="dropdown-item"><!----> <a href="/cloudflare/tunnel.html" class="nav-link">
  Cloudflare
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="打包工具" class="dropdown-title"><span class="title">打包工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="打包工具" class="mobile-dropdown-title"><span class="title">打包工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/webpack/base.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/rollup/base.html" class="nav-link">
  Rollup
</a></li></ul></div></div><div class="nav-item"><a href="/node/" class="nav-link">
  Node
</a></div><div class="nav-item"><a href="/leetcode/array.html" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/test/" class="nav-link">
  常见问题
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vue/" aria-current="page" class="sidebar-link">Vue核心</a></li><li><a href="/vue/1.html" class="sidebar-link">Vue常用</a></li><li><a href="/vue/2.html" aria-current="page" class="active sidebar-link">Vue路由</a></li><li><a href="/vue/3.html" class="sidebar-link">Vue组件</a></li><li><a href="/vue/defineReactive.html" class="sidebar-link">Vue 响应式数据源码解析</a></li><li><a href="/vue/render.html" class="sidebar-link">Vue 模板编译源码解析</a></li><li><a href="/vue/mount.html" class="sidebar-link">Vue 初始化渲染源码解析</a></li><li><a href="/vue/observer.html" class="sidebar-link">Vue 渲染更新源码解析</a></li><li><a href="/vue/nextTick.html" class="sidebar-link">Vue 异步更新源码解析</a></li><li><a href="/vue/watch.html" class="sidebar-link">Vue 侦听器(watch)源码解析</a></li><li><a href="/vue/computed.html" class="sidebar-link">Vue 计算属性(computed)源码解析</a></li><li><a href="/vue/lifecycle.html" class="sidebar-link">Vue 生命周期源码解析</a></li><li><a href="/vue/domdiff.html" class="sidebar-link">Vue DOMdiff(patch)源码解析</a></li><li><a href="/vue/vuex.html" class="sidebar-link">Vuex源码解析</a></li><li><a href="/vue/seo.html" class="sidebar-link">Vue首屏渲染优化与SEO</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p></p><div class="table-of-contents"><ul><li><a href="#什么是spa">什么是SPA</a></li><li><a href="#前端路由的出现">前端路由的出现</a></li><li><a href="#vue-router">Vue-router</a><ul><li><a href="#原理">原理</a></li><li><a href="#hash模式">hash模式</a></li><li><a href="#history模式">history模式</a></li><li><a href="#hash、history模式的选择">hash、history模式的选择</a></li></ul></li><li><a href="#vue-router的使用">vue-router的使用</a></li><li><a href="#实例化vuerouter">实例化VueRouter</a><ul><li><a href="#router-view">router-view</a></li><li><a href="#router-link">router-link</a></li></ul></li><li><a href="#路由信息与方法">路由信息与方法</a><ul><li><a href="#router">$router</a></li><li><a href="#route">$route</a></li></ul></li><li><a href="#路由的嵌套">路由的嵌套</a></li><li><a href="#动态路由">动态路由</a></li></ul></div><p></p> <h1 id="vue路由"><a href="#vue路由" class="header-anchor">#</a> Vue路由</h1> <h2 id="什么是spa"><a href="#什么是spa" class="header-anchor">#</a> 什么是SPA</h2> <div class="custom-block tip"><p class="custom-block-title">SPA</p> <p>SPA 是single page application 的简称，翻译为单页应用。
简单来说SPA就是一个Web项目只有一个HTML页面，一但页面加载完成，SPA不会因为用户的操作而进行页面的重新加载或跳转。取而代之的是利用JS动态的变换HTML的内容，来模拟多个视图之间的跳转。</p></div> <h2 id="前端路由的出现"><a href="#前端路由的出现" class="header-anchor">#</a> 前端路由的出现</h2> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>随着<code>AJAX</code>技术的出现，才逐渐演化出了SPA，SPA的出现大大提高了用户的体验。在于用户的交互中，不再需要刷新页面，通过<code>AJAX</code>技术异步获取数据，页面展示变得更加流畅。</p> <p>但由于SPA中用户的交互是通过<code>JS</code>改变<code>HTML</code>内容来实现的，页面本身的URL并没有发生变化，这导致了两个问题：</p> <ul><li>1、SPA无法记录用户的前进、后退操作</li> <li>2、SPA中虽然业务的不同会有多种页面的展示，但是只有一个<code>URL</code>，对用户来说不够友好，每次刷新页面，都要重新点一遍要去到的页面</li> <li>3、没有路径-页面的统一概念，页面管理复杂，维护起来不友好</li></ul> <p>前端路由就是为了解决上述问题而出现的，如<code>vue-router，react-router</code></p></div> <h2 id="vue-router"><a href="#vue-router" class="header-anchor">#</a> Vue-router</h2> <div class="custom-block tip"><p class="custom-block-title">路由</p> <p>前端路由就是一个路径管理器，通俗的说，<code>vue-router</code>就是一个<code>WebApp</code>的链接路径管理系统。vue的单页面应用是基于路由和组件的，路由用来设置访问路径，相当于页面对应的<code>URL</code>，并将路径和组件映射起来。
传统的页面应用，是采用超链接的方式来实现页面切换和跳转的。在<code>vue-router</code>中，则是路径之间的切换，也就是组件的切换。
路由模块的本质就是建立起<code>URL</code>和页面之间的映射关系，在刷新、前进、后退时均通过<code>url</code>来实现。</p> <p>为什么不用<code>a</code>标签：
因为用vue做的都是单页应用，相当于只有一个主<code>index.html</code>(也就)，所以<code>a</code>标签是起不到作用的，你必须使用<code>vue-router</code>来管理。</p></div> <h3 id="原理"><a href="#原理" class="header-anchor">#</a> 原理</h3> <div class="custom-block tip"><p class="custom-block-title">原理</p> <p>简单的说，只有一个HTML页面，为每一个组件匹配一个路由（访问路径）。在用户刷新、前进、后退、跳转操作时，不更新整个页面，而是根据路由只更新某个组件。
要做到上面的需求我们满足以下两个核心：</p> <ul><li>1、改变<code>url</code>而不让浏览器向服务器发送请求。</li> <li>2、可以监听到url的变化，并执行对应的操作（如组件切换）</li></ul> <p>对此，有两种模式实现的以上的功能：<code>hash模式</code> 和 <code>history模式</code></p></div> <h3 id="hash模式"><a href="#hash模式" class="header-anchor">#</a> hash模式</h3> <div class="custom-block tip"><p class="custom-block-title">hash</p> <p><code>vue-router</code>默认采用<code>hash</code>模式：使用<code>url</code>后的<code>#</code>后面的字符。比如<code>www.baidu.com/#aaaa</code>其中的<code>#aaaa</code>就是我们要的<code>hash</code>值。
为什么可以用<code>hash</code>：</p> <ul><li>1、<code>hash</code>值的变化不会导致浏览器向服务器发送请求，不会引起页面刷新。</li> <li>2、<code>hash</code>值的变化改变会触发<code>hashchange</code>事件</li> <li>3、<code>hash</code>值改变也会在浏览器的历史中留下记录，使用浏览器的<code>后退</code>按钮，就可以回到上一个<code>hash</code>值</li></ul> <p>在<code>H5</code>的<code>history</code>模式出现之前，基本都是使用<code>hash</code>模式实现前端路由的</p></div> <h3 id="history模式"><a href="#history模式" class="header-anchor">#</a> history模式</h3> <div class="custom-block tip"><p class="custom-block-title">history</p> <p>在<code>HTML5</code>之前，浏览器就已经有了<code>history</code>对象。但是只能用于页面跳转</p> <ul><li><code>history.go(n)</code> // 前进或者后退，n代表页数，负数表示后退</li> <li><code>history.forward()</code> // 前进一页</li> <li><code>history.back()</code> // 后退一页</li></ul> <p>在<code>HTML5</code>中，history新增了以下API</p> <ul><li><code>history.pushState()</code> // 向历史栈中添加一新的状态</li> <li><code>history.replaceState()</code> // 修改当前项在历史栈中的记录</li> <li><code>history.state</code> // 返回当前状态对象</li></ul> <p><code>pushState</code>和<code>replaceState</code>均接收三个参数(state,title,url)</p> <ul><li><code>state</code>: 合法的js对象，可以用在<code>popstate</code>事件中</li> <li><code>title</code>: 大多数浏览器忽略这个参数，可以传null占位</li> <li><code>url</code>: 任意有效的URL（必须与当前url同源，否则会抛出异常），用于更新浏览器的url。在调用<code>pushState</code>或<code>replaceState</code>之后，会立即产生一个新的带有新url的历史记录（当前url已变成最新的），但浏览器不会立即加载这个url（页面不会刷新），可能会在稍后某些情况下加载这个url，比如用户重新打开浏览器或在地址栏中按回车键。</li></ul> <p><code>pushState</code>和<code>replaceState</code>的区别在于：</p> <ul><li><code>pushState</code>会保留现有历史记录的同时，将带有新url的记录添加到历史栈中。</li> <li><code>replaceState</code>会将历史栈中的当前页面历史中的<code>state、url</code>替换为最新的</li></ul> <p>由于<code>pushState</code>和<code>replaceState</code>方法可以在改变当前url的同时，并不刷新页面，这样就可以用来实现前端路由。</p> <p>但是由于调用<code>pushState</code>和<code>replaceState</code>不会触发事件（<code>popstate</code>事件只有在用户手动点击前进、后退按钮或者在js中调用<code>go、back、forward</code>方法时才会触发），所以有对应的解决方案：</p> <ul><li>1、点击前进、后退按钮或者在<code>js</code>中调用<code>go、back、forward</code>方法：监听<code>popstate</code>事件，在事件回调中根据当前的<code>url</code>，渲染对应的页面即可。</li> <li>2、当需要跳转路径时(调用<code>push</code>方法时)：先根据拿到的路径渲染对应的页面，然后在页面渲染完成之后通过<code>pushState</code>或<code>replaceState</code>方法来更新浏览器的url。</li></ul> <p>这样就实现了history模式的前端路由</p> <p>history 在修改了url后，虽然页面不会刷新，但是我们在手动刷新页面之后，浏览器会以当前url向服务器发送请求，但是由于我们只有一个<code>html</code>文件,浏览器在处理其他路径的时候，就会出现404的情况。此时需要在服务端增加一个覆盖所有情况的候选资源：如果url匹配不到静态资源，就返回单页应用的<code>html</code>文件。这样，就完全交给了前端来处理对应的路由。</p></div> <h3 id="hash、history模式的选择"><a href="#hash、history模式的选择" class="header-anchor">#</a> hash、history模式的选择</h3> <div class="custom-block tip"><p class="custom-block-title">区别</p> <p><code>hash</code>优点:</p> <ul><li>1、兼容性好，可以兼容IE8</li> <li>2、不需要服务端做任何配置即可处理单页应用</li></ul> <p>缺点:</p> <ul><li>1、路径丑</li> <li>2、锚点功能会失效</li> <li>3、相同的<code>hash</code>不会更新历史栈</li></ul> <p><code>history</code>优点：</p> <ul><li>1、路径更好看</li> <li>2、锚点功能可用</li> <li>3、<code>pushState</code>可添加相同的记录到历史栈中</li></ul> <p>缺点：</p> <ul><li>1、兼容性差，不能兼容IE9</li> <li>2、需要服务端支持</li></ul></div> <h2 id="vue-router的使用"><a href="#vue-router的使用" class="header-anchor">#</a> vue-router的使用</h2> <div class="custom-block tip"><p class="custom-block-title">注入vue-router</p> <ul><li><p>1、在要使用路由的项目中打开<code>CMD</code>命令 输入<code>npm install vue-router</code>,安装<code>vue</code>的路由模块</p></li> <li><p>2、在页面中先引入<code>vue.js</code>,再引入<code>vue-router.js</code>，因为<code>vue-router</code>是基于<code>vue</code>的。利用<code>Vue.js</code>提供的插件机制，<code>Vue.use(plugin)</code>来安装<code>VueRouter</code>，这样做的目的是为了不依赖<code>Vue</code>的版本，两者的版本可以混用。这个插件机制的原理是调用插件的<code>install</code>方法（如果有<code>install</code>方法，没有就把传入的插件当成函数调用）。</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> VueRouter <span class="token keyword">from</span> <span class="token string">'vue-router'</span>
<span class="token comment">// 将VueRouter当做插件传入：目的是为了不依赖vue，可以版本混用，也可以只用VueRouter</span>
Vue<span class="token punctuation">.</span><span class="token function-variable function">use</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">plugin<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  plugin<span class="token punctuation">.</span><span class="token function">install</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueRouter<span class="token punctuation">)</span> <span class="token comment">// 会调用插件的install方法并把Vue传进去</span>
</code></pre></div><p><code>install.js</code>的作用：</p> <ul><li>1、引入<code>Vue</code>并保存，方便之后使用</li> <li>2、将根组件注入到每一个组件上，保证每一个<code>Vue</code>的实例都可以拿到根组件上的router属性</li> <li>3、实现路由响应式原理，将根组件上的<code>_route</code>属性定义为响应式数据，这样<code>_route</code>属性改变就可以更新视图</li> <li>4、初始化路由</li> <li>5、注册全局路由组件</li></ul> <div class="language-js install.js extra-class"><pre class="language-js"><code><span class="token comment">// install.js</span>
<span class="token keyword">import</span> View <span class="token keyword">from</span> <span class="token string">'./components/view'</span>
<span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">'./components/link'</span>

<span class="token keyword">export</span> <span class="token keyword">let</span> _Vue 

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">install</span><span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  _Vue <span class="token operator">=</span> Vue
  <span class="token comment">// 采用mixin 的 方式，将根组件注入到每一个组件上</span>
  Vue<span class="token punctuation">.</span><span class="token function">mixin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function">beforeCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">// 存在router属性则代表是根组件</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span>router<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_routeRoot <span class="token operator">=</span> <span class="token keyword">this</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_router <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span>router
        <span class="token comment">/* 
          此处init要放在defineReactive之前。
          因为首次渲染已经存在路径，需要在init时 transitionTo更新history.current，
          init之后，此时history.current已经是当前url对应的路由对应的记录，
          接下来我们只需要在 根组件上定义响应式属性_route，指向最新的路由记录，即可更新视图
        */</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_router<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
        Vue<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token string">'_route'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_router<span class="token punctuation">.</span>history<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_routeRoot <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$parent <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">.</span>_routeRoot <span class="token operator">||</span> <span class="token keyword">this</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 为了在组件中方便使用属性路由属性，增加属性代理</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>Vue<span class="token punctuation">.</span>property<span class="token punctuation">,</span> <span class="token string">'$route'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_routeRoot<span class="token punctuation">.</span>_route
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>Vue<span class="token punctuation">.</span>property<span class="token punctuation">,</span> <span class="token string">'$router'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_routeRoot<span class="token punctuation">.</span>_router
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'RouterView'</span><span class="token punctuation">,</span> View<span class="token punctuation">)</span>
  Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'RouterLink'</span><span class="token punctuation">,</span> Link<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h2 id="实例化vuerouter"><a href="#实例化vuerouter" class="header-anchor">#</a> 实例化VueRouter</h2> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>1、声明创建路由表，在路由表中将路径和对应的组件关联起来</li> <li>2、创建路由实例，初始化路由并传入路由表</li> <li>3、在vue的实例中注册路由</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App'</span>
<span class="token keyword">let</span> Home <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">template</span><span class="token operator">:</span><span class="token string">'&lt;div&gt;首页&lt;/div&gt;'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> List <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">template</span><span class="token operator">:</span><span class="token string">'&lt;div&gt;列表页&lt;/div&gt;'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token comment">// 1、创建路由实例</span>
<span class="token keyword">let</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token comment">//初始化路由：传入路由表</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'history'</span><span class="token punctuation">,</span> <span class="token comment">// 需要后端做支持</span>
  <span class="token literal-property property">routes</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token comment">// 一级路径前必须加 ‘/’</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token literal-property property">component</span><span class="token operator">:</span>Home <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment">//默认展示的路由（默认展示的不需要加/）</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/home'</span><span class="token punctuation">,</span> <span class="token literal-property property">component</span><span class="token operator">:</span>Home <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment">//一个路径对应一个组件</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/list'</span><span class="token punctuation">,</span> <span class="token literal-property property">component</span><span class="token operator">:</span>List <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token literal-property property">redirect</span><span class="token operator">:</span><span class="token string">'/home'</span> <span class="token punctuation">}</span><span class="token comment">//用户随便输入路径时，重定向到home组件，防止出现404</span>
  <span class="token punctuation">]</span> <span class="token comment">// es6简写</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//2、在vue根实例中注入路由实例，之后就可以在页面中使用了</span>
<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">el</span><span class="token operator">:</span><span class="token string">'#app'</span><span class="token punctuation">,</span>
  router<span class="token punctuation">,</span> <span class="token comment">// 注入路由（es6简写）</span>
  <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token parameter">h</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vue路由src/index.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">VueRouter</span> <span class="token punctuation">{</span>
  <span class="token comment">// 会根据对应的模式生成对应的 history实例，挂载到当前类的实例上</span>
  <span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter">app</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 此处传入的是在install.js中调用router.init时 传入的根组件的实例</span>
    <span class="token keyword">const</span> history <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>history
    <span class="token keyword">const</span> <span class="token function-variable function">setupListener</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token comment">// 方便加一些其他的操作</span>
      history<span class="token punctuation">.</span><span class="token function">setupListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token comment">// todo...</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 拿到当前的路径，调用transitionTo方法，根据路径匹配到对应的路由记录route，</span>
    history<span class="token punctuation">.</span><span class="token function">transitionTo</span><span class="token punctuation">(</span>history<span class="token punctuation">.</span><span class="token function">getCurrentLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> setupListener<span class="token punctuation">)</span>
    history<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token parameter">route</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token comment">/* 
      因为在install.js中 根（app）组件的_route属性已经被定义为了响应式的
      Vue.util.defineReactive(this, '_route', this._router.history.current)
      所以只需要更新数据，就可以驱动视图更新
    */</span>
      app<span class="token punctuation">.</span>_route <span class="token operator">=</span> route
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h3 id="router-view"><a href="#router-view" class="header-anchor">#</a> <code>router-view</code></h3> <div class="custom-block tip"><p class="custom-block-title">router-view</p> <p><code>router-view</code>（全局组件：用来渲染路由对应的组件）
在页面中使用<code>router-view</code>这个全局组件来将路由对应的页面渲染到页面上</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></div> <h3 id="router-link"><a href="#router-link" class="header-anchor">#</a> <code>router-link</code></h3> <div class="custom-block tip"><p class="custom-block-title">router-link</p> <p>使用<code>router-link</code>全局组件，来实现点击跳转</p> <p><code>router-link</code>存在两个属性：</p> <ul><li><code>to</code>：跳转到哪个（必须加，值为要跳转的路径）</li> <li><code>tag</code>：要把<code>router-link</code>变为哪个标签（不改默认是<code>a</code>标签）</li></ul> <div class="language-html extra-class"><pre class="language-html"><code>	<span class="token comment">&lt;!-- 修改上面的HTML如下 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/home<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tag</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>首页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tag</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>列表页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 如果写成对象的形式，而且需要params参数的话，就只能用name来实现跳转了(用ptah的话会导致params不生效) --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{name:'list',params:{userId:1}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tag</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>列表页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><code>router-link</code>和<code>a</code>标签的区别
<code>router-link</code>默认会使用<code>a</code>标签，但是给<code>a</code>标签添加了点击事件，并没有直接使用<code>a</code>标签的<code>href</code>属性去跳转，通过<code>a</code>标签的点击事件，在事件中拿到要跳转的路径，并根据路由匹配出对应的页面并展示，而不用刷新整个页面。而<code>a</code>标签是利用的<code>href</code>属性去做的页面的跳转，这样的话整个页面都会刷新。</p></div> <h2 id="路由信息与方法"><a href="#路由信息与方法" class="header-anchor">#</a> 路由信息与方法</h2> <div class="custom-block tip"><p class="custom-block-title">路由</p> <p>当在<code>vue</code>的实例中注册过路由之后，每个vue组件实例都可以通过获取<code>$router</code>、<code>$route</code>属性来获取根组件上的<code>_router</code>、<code>_route</code>属性(因为在<code>Vue.use</code>注入的时候，<code>install.js</code>中已经做了代理)；</p> <ul><li><code>$route</code>：路由信息对象，表示当前激活的路由的状态信息，包含了当前URL解析的信息，还有URL匹配到的路由记录</li> <li><code>$router</code>：当前的路由的实例，原型上有各种跳转的方法</li></ul></div> <h3 id="router"><a href="#router" class="header-anchor">#</a> <code>$router</code></h3> <div class="custom-block tip"><p class="custom-block-title">其原型上存储了跳转的方法</p> <ul><li><code>this.$router.push()</code>：强制跳转到某个路径，参数为路径</li> <li><code>this.$router.replace()</code>：路由替换，将当前路径替换为新的路径（很少用到）</li> <li><code>this.$router.go()</code>：返回某一级，参数为返回多少级（-1为上一级，1为下一级）</li></ul></div> <h3 id="route"><a href="#route" class="header-anchor">#</a> <code>$route</code></h3> <div class="custom-block tip"><p class="custom-block-title">路由信息对象，表示当前激活的路由的状态信息</p> <p>当前激活的路由信息对象。这个属性是只读的，里面的属性是 immutable (不可变) 的，不过可以 <code>watch</code> (监测变化) 它。</p> <ul><li><code>$route.path</code>：字符串，对应当前路由的路径，总是解析为绝对路径，如 <code>/foo/bar</code>。</li> <li><code>$route.params</code>：一个 <code>key/value</code> 对象，包含了动态片段和全匹配片段，如果没有路由参数，就是一个空对象。</li> <li><code>$route.query</code>：一个 <code>key/value</code> 对象，表示 <code>URL</code> 查询参数。例如，对于路径 <code>/foo?user=1</code>，则有 <code>$route.query.user == 1</code>，如果没有查询参数，则是个空对象。</li> <li><code>$route.hash</code>：当前路由的 <code>hash</code> 值 (带 <code>#</code>) ，如果没有 <code>hash</code> 值，则为空字符串。</li> <li><code>$route.fullPath</code>：完成解析后的 <code>URL</code>，包含查询参数和 <code>hash</code> 的完整路径。</li> <li><code>$route.name</code>：当前路由的名称，如果有的话。</li> <li><code>$route.redirectedFrom</code>：如果存在重定向，即为重定向来源的路由的名字。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//由于路径有很多，而我们不能把路径写死，所以要写成类似正则的形式来匹配路径</span>
 <span class="token operator">/</span>article<span class="token operator">/</span><span class="token number">2</span><span class="token operator">/</span>d <span class="token comment">//一个路径</span>
 <span class="token operator">/</span>article<span class="token operator">/</span><span class="token operator">:</span>c<span class="token operator">/</span><span class="token operator">:</span>a <span class="token comment">//表示路径匹配，和上面的匹配后产生一个对象，存在$route.params当中：{c:2,a:d}</span>
</code></pre></div><p><strong><code>params</code>传参和<code>query</code>传参的区别</strong></p> <ul><li><code>params</code>要用<code>name</code>来引入，接收参数用<code>this.route.params.xxx</code><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//params语法：刷新页面会消失</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&quot;Search&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">params</span><span class="token operator">:</span><span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">123</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//这是传递参数</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id； <span class="token comment">//这是接收参数</span>

<span class="token comment">// 如果是路径参数，需要用path  /a/:userId  路径参数的话刷新是不会消失的</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">&quot;/a/123&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//这是传递参数</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>userId <span class="token comment">//这是接收参数</span>
</code></pre></div></li> <li><code>query</code>要用<code>path</code>来引入，接收参数用<code>this.route.query.xxx</code><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//query语法：</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">&quot;/a&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">query</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">123</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//这是传递参数</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>id； <span class="token comment">//这是接收参数</span>
</code></pre></div></li></ul> <p><strong><code>注意</code></strong><br> <code>query</code>刷新不会丢失<code>query</code>里面的数据（因为会带到<code>url</code>上），<code>params</code>如果是路径参数的话，因为也会映射到url中，所以刷新也不会消失，如果不是路径参数的话，通过<code>name</code>的方式进入组件，<code>params</code>传参的话，刷新会丢失<code>params</code>里面的数据。</p></div> <h2 id="路由的嵌套"><a href="#路由的嵌套" class="header-anchor">#</a> 路由的嵌套</h2> <blockquote><p>可在路由表中嵌套二级路由，嵌套二级路由的一级路由的<code>template</code>也要做对应的修改；</p></blockquote> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/home<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>首页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/detail<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>详情页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!--一级路由显示区域--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>detail<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/detail/info<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>个人中心<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/detail/about<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>关于我<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!--二级路由显示区域--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//组件</span>
<span class="token keyword">let</span> home<span class="token operator">=</span><span class="token punctuation">{</span><span class="token literal-property property">template</span><span class="token operator">:</span><span class="token string">'&lt;div&gt;home&lt;/div&gt;'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> detail<span class="token operator">=</span><span class="token punctuation">{</span><span class="token literal-property property">template</span><span class="token operator">:</span><span class="token string">'#detail'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> info<span class="token operator">=</span><span class="token punctuation">{</span><span class="token literal-property property">template</span><span class="token operator">:</span><span class="token string">'&lt;div&gt;info&lt;/div&gt;'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> about<span class="token operator">=</span><span class="token punctuation">{</span><span class="token literal-property property">template</span><span class="token operator">:</span><span class="token string">'&lt;div&gt;about&lt;/div&gt;'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//创建路由表</span>
<span class="token keyword">let</span> routes<span class="token operator">=</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">'/home'</span><span class="token punctuation">,</span><span class="token literal-property property">component</span><span class="token operator">:</span>home <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">'/detail'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span>detail<span class="token punctuation">,</span>
    <span class="token comment">//二级路由写在childern属性当中</span>
    <span class="token literal-property property">children</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token comment">//二级以及二级以上路由的路径永远不带‘/’，如果带‘/’代表是一级路由</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">'info'</span><span class="token punctuation">,</span><span class="token literal-property property">component</span><span class="token operator">:</span>info <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">'about'</span><span class="token punctuation">,</span><span class="token literal-property property">component</span><span class="token operator">:</span>about <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//初始化路由并传入路由表</span>
<span class="token keyword">let</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> 
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'history'</span><span class="token punctuation">,</span>
  routes
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">el</span><span class="token operator">:</span><span class="token string">'#app'</span><span class="token punctuation">,</span>
  <span class="token comment">//注册路由</span>
  router
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="动态路由"><a href="#动态路由" class="header-anchor">#</a> 动态路由</h2> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>需要用到的方法：</p> <ul><li><code>router.beforeEach</code>：<code>vue-router</code> 提供的导航守卫主要用来通过跳转或取消的方式守卫导航。有多种机会植入路由导航过程中：全局的, 单个路由独享的, 或者组件级的。</li> <li><code>router.addRoutes()</code>：动态挂载路由（此方法的作用只是在路径中访问时可以看到对应的页面，但是菜单展示还需要），参数必须是一个符合 <code>routes</code> 选项要求的数组</li></ul> <p>这里还有一个小<code>hack</code>的地方，就是<code>router.addRoutes</code>之后的<code>next()</code>可能会失效，因为可能<code>next()</code>的时候路由并没有完全<code>add</code>完成，好在查阅文档发现<code>next('/')</code> or <code>next({ path: '/' })</code>: redirect to a different location. The current navigation will be aborted and a new one will be started.</p> <p>这样我们就可以简单的通过<code>next(to)</code>巧妙的避开之前的那个问题了。这行代码重新进入<code>router.beforeEach</code>这个钩子函数，这时候再通过<code>next()</code>来释放钩子，就能确保所有的路由都已经挂载完成了。</p> <p><code>router index.js</code>文件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> Router <span class="token keyword">from</span> <span class="token string">'vue-router'</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Router<span class="token punctuation">)</span>

<span class="token comment">// 创建静态路由表</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> constantRouterMap <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/404'</span><span class="token punctuation">,</span> <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/404'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token literal-property property">hidden</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> Layout<span class="token punctuation">,</span>
    <span class="token literal-property property">redirect</span><span class="token operator">:</span> <span class="token string">'/home'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
      <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span>
      <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/home/index'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'首页'</span><span class="token punctuation">,</span> <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'home'</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token comment">// 初始化路由传入静态路由表并导出</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'history'</span><span class="token punctuation">,</span><span class="token comment">// 使用history模式</span>
  <span class="token function-variable function">scrollBehavior</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">routes</span><span class="token operator">:</span> constantRouterMap
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 全部路由（需要过滤的动态路由表，以后加项目的话直接加在这里即可,拉到权限后需要根据权限过滤此表)</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> asyncRouterMap <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token comment">// 权限管理</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/access'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> Layout<span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'access'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'index'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'access/index'</span><span class="token punctuation">,</span>
        <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/access/index'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'权限管理'</span><span class="token punctuation">,</span> <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'lock'</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 运营后台</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/operation'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> Layout<span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'operation'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'运营后台'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'operation'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token comment">// 映客直播</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'live'</span><span class="token punctuation">,</span>
        <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/operation/index'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Parent router-view</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'operation/live'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'映客直播'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token comment">// 意见反馈</span>
          <span class="token punctuation">{</span>
            <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'feedback'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'operation/live/feedback'</span><span class="token punctuation">,</span>
            <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/feedback/index'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'意见反馈'</span> <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><p>路由创建好之后需要在拉取权限之后对全局路由表进行过滤，筛选掉没有用的路由。</p></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">8/4/2021, 7:07:55 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vue/1.html" class="prev">
        Vue常用
      </a></span> <span class="next"><a href="/vue/3.html">
        Vue组件
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.acb235b1.js" defer></script><script src="/assets/js/2.d372d77b.js" defer></script><script src="/assets/js/1.37fa4b6c.js" defer></script><script src="/assets/js/105.c8937ef6.js" defer></script>
  </body>
</html>
